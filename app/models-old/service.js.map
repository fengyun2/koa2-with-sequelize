{"version":3,"sources":["../../src/models-old/service.js"],"names":[],"mappings":"0WAAA,IAAM,WAAW,QAAQ,SAAR,EAAmB,QAApC;AACI,UAAU,QAAQ,MAAR,CADd;;AAGA,OAAO,OAAP,GAAiB;AACb;AACA,+FAAQ,iBAAe,GAAf;AACc,wCAAQ,MAAR,CAAe,KAAK,cAApB,EAAoC,GAApC,CADd,SACE,GADF;AAEG,+BAFH,gEAAR,6EAFa;;;AAOb;AACA,gGAAQ,kBAAe,GAAf;AACc,wCAAQ,MAAR,CAAe,KAAK,cAApB,EAAoC,GAApC,CADd,SACE,GADF;AAEG,+BAFH,kEAAR,+EARa;;;AAab;AACA,gGAAQ,kBAAe,EAAf;AACc,wCAAQ,MAAR,CAAe,KAAK,cAApB,EAAoC;AAClD,yCAAK,IAAI,QAAJ,CAAa,EAAb,CAD6C,EAApC,CADd,SACE,GADF;;AAIG,+BAJH,kEAAR,+EAda;;;AAqBb;AACA,8FAAM,kBAAe,KAAf,EAAsB,MAAtB;AACgB,wCAAQ,IAAR,CAAa,KAAK,cAAlB,EAAkC,KAAlC,EAAyC,MAAzC,CADhB,SACI,GADJ;AAEK,+BAFL,kEAAN,gFAtBa;;;AA2Bb;AACA,iGAAS,kBAAe,KAAf,EAAsB,MAAtB;AACa,wCAAQ,OAAR,CAAgB,KAAK,cAArB,EAAqC,KAArC,EAA4C,MAA5C,CADb,SACC,GADD;AAEE,+BAFF,kEAAT,sFA5Ba;;;AAiCb;AACA,gGAAQ;AACc,wCAAQ,IAAR,CAAa,KAAK,cAAlB,EAAkC,EAAlC,CADd,SACE,GADF,kFAAR,4EAlCa;;;AAsCb;AACA,iGAAS,kBAAe,EAAf;AACa,wCAAQ,OAAR,CAAgB,KAAK,cAArB,EAAqC;AACnD,yCAAK,IAAI,QAAJ,CAAa,EAAb,CAD8C,EAArC,CADb,SACC,GADD,kFAAT,iFAvCa;;;;AA6Cb;AACA,kGAAU,kBAAe,GAAf,EAAoB,MAApB;AACN,kCAAM,IAAI,GAAJ,CAAQ,UAAU,EAAV,EAAc;AACxB,oCAAI,QAAJ,CAAa,EAAb;AACH,6BAFK,CAAN,CADM;AAIY,wCAAQ,IAAR,CAAa,KAAK,cAAlB,EAAkC;AAChD,yCAAK;AACD,6CAAK,GADJ,EAD2C,EAAlC;;AAIf,sCAJe,CAJZ,SAIA,GAJA;AASC,+BATD,kEAAV,yFA9Ca;;;AA0Db;AACA,mGAAW,kBAAe,KAAf,EAAsB,IAAtB,EAA4B,QAA5B,EAAsC,OAAtC;AACP,gCAAI,CAAC,KAAL,EAAY,QAAQ,EAAR;AACZ,gCAAI,CAAC,IAAL,EAAW,OAAO;AACd,6BAAC,KAAD,EAAQ,MAAR,CADc,CAAP;;AAGL,kCALC,GAKQ;AACX,sCAAM,IADK;AAEX,uCAAO,QAFI;AAGX,sCAAM,CAAC,UAAU,CAAX,IAAgB,QAHX,EALR;;AAUW,wCAAQ,IAAR,CAAa,KAAK,cAAlB,EAAkC,KAAlC,EAAyC,MAAzC,CAVX,SAUD,GAVC;AAWA,+BAXA,kEAAX,wGA3Da;;;AAyEb;AACA,gGAAO,mBAAe,KAAf;AACH,gCAAI,CAAC,KAAL,EAAY,QAAQ,EAAR,CADT;AAEe,wCAAQ,KAAR,CAAc,KAAK,cAAnB,EAAmC,KAAnC,CAFf,SAEG,GAFH,qFAAP,+EA1Ea,EAAjB","file":"service.js","sourcesContent":["const ObjectID = require('mongodb').ObjectID,\r\n    mongodb = require('./db')\r\n\r\nmodule.exports = {\r\n    // 创建\r\n    insert: async function(obj) {\r\n        const res = await mongodb.insert(this.collectionName, obj)\r\n        return res\r\n    },\r\n\r\n    // 更新\r\n    update: async function(obj) {\r\n        const res = await mongodb.update(this.collectionName, obj)\r\n        return res\r\n    },\r\n\r\n    // 删除\r\n    remove: async function(id) {\r\n        const res = await mongodb.remove(this.collectionName, {\r\n            _id: new ObjectID(id)\r\n        })\r\n        return res\r\n    },\r\n\r\n    // 查询多条\r\n    find: async function(query, option) {\r\n        const res = await mongodb.find(this.collectionName, query, option)\r\n        return res\r\n    },\r\n\r\n    // 查询单条\r\n    findOne: async function(query, option) {\r\n        const res = await mongodb.findOne(this.collectionName, query, option)\r\n        return res\r\n    },\r\n\r\n    // 获取全部\r\n    getAll: async function() {\r\n        const res = await mongodb.find(this.collectionName, {})\r\n    },\r\n\r\n    // 按id查询\r\n    getById: async function(id) {\r\n        const res = await mongodb.findOne(this.collectionName, {\r\n            _id: new ObjectID(id)\r\n        })\r\n    },\r\n\r\n    // 按照很多id来查询\r\n    getByIds: async function(ids, option) {\r\n        ids = ids.map(function (id) {\r\n            new ObjectID(id)\r\n        })\r\n        const res = await mongodb.find(this.collectionName, {\r\n            _id: {\r\n                $in: ids\r\n            }\r\n        }, option)\r\n        return res\r\n    },\r\n\r\n    // 列出(带分页)\r\n    getByPage: async function(query, sort, pageSize, pageNum) {\r\n        if (!query) query = {}\r\n        if (!sort) sort = [\r\n            ['_id', 'desc']\r\n        ]\r\n        const option = {\r\n            sort: sort,\r\n            limit: pageSize,\r\n            skip: (pageNum - 1) * pageSize\r\n        }\r\n        const res = await mongodb.find(this.collectionName, query, option)\r\n        return res\r\n    },\r\n\r\n    // 计数\r\n    count: async function(query) {\r\n        if (!query) query = {}\r\n        const res = await mongodb.count(this.collectionName, query)\r\n    }\r\n}\r\n"]}