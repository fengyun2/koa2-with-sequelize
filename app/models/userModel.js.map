{"version":3,"sources":["../../src/models/userModel.js"],"names":[],"mappings":";;AAEA,kD;;AAEA;;;;;AAKA,IAAM,OAAO,SAAP,IAAO,CAAC,IAAD,EAAU;AACnB,QAAM,SAAS,yBAAc,IAAd,CAAf;AACA,WAAO,sBAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;AACpC,eAAO,IAAP,CAAY,UAAC,GAAD,EAAM,MAAN,EAAiB;AACzB,gBAAI,GAAJ,EAAS;AACL,uBAAO,OAAO,EAAE,KAAK,IAAI,MAAX,EAAmB,SAAS,IAAI,OAAhC,EAAyC,QAAQ,CAAC,EAAlD,EAAP,CAAP;AACH;AACD,mBAAO,QAAQ,MAAR,CAAP;AACH,SALD;AAMH,KAPM,CAAP;AAQH,CAVD;;AAYA;;;;;;OArBA;AA4BA,IAAM,UAAU,SAAV,OAAU,CAAC,UAAD,EAAa,MAAb,EAAqB,OAArB,EAAiC;AAC7C;;AAEA,WAAO,sBAAY,UAAC,OAAD,EAAU,MAAV,EAAqB;AACpC,6BAAU,OAAV,CAAkB,UAAlB,EAA8B,MAA9B,EAAsC,OAAtC,EAA+C,IAA/C,CAAoD,UAAC,GAAD,EAAM,GAAN,EAAc;AAC9D,gBAAI,GAAJ,EAAS,OAAO,OAAO,EAAE,KAAK,IAAI,MAAX,EAAmB,SAAS,OAA5B,EAAqC,QAAQ,CAAC,EAA9C,EAAP,CAAP;AACT,gBAAI,CAAC,GAAL,EAAU,OAAO,OAAO,EAAE,KAAK,IAAI,MAAX,EAAmB,SAAS,QAA5B,EAAsC,QAAQ,CAAC,EAA/C,EAAP,CAAP;AACV,mBAAO,QAAQ,GAAR,CAAP;AACH,SAJD;AAKH,KANM,CAAP;AAOH,CAVD;;AAYA,IAAM,SAAS,SAAT,MAAS,CAAC,KAAD,EAAQ,OAAR,EAAiB,QAAjB,EAA8B;AACzC,yBAAU,MAAV,CAAiB,KAAjB,EAAwB,OAAxB,EAAiC,EAAE,OAAO,IAAT,EAAjC,EAAkD,UAAC,GAAD,EAAM,cAAN,EAAsB,GAAtB,EAA8B;AAC5E,YAAI,GAAJ,EAAS,OAAO,SAAS,GAAT,CAAP;AACT,iBAAS,IAAT,EAAe,cAAf;AACH,KAHD;AAIH,CALD,C;;AAOe;AACX,cADW;AAEX,oBAFW;AAGX,kBAHW,E","file":"userModel.js","sourcesContent":["///<reference path=\"../../typings/index.d.ts\" />\r\n\r\nimport UserModel from '../schema/userSchema';\r\n\r\n/**\r\n * [添加用户]\r\n * @param  {[object]} user [description]\r\n * @return {[type]}      [description]\r\n */\r\nconst save = (user) => {\r\n    const action = new UserModel(user);\r\n    return new Promise((resolve, reject) => {\r\n        action.save((err, result) => {\r\n            if (err) {\r\n                return reject({ err: err.errors, message: err.message, status: -99 });\r\n            }\r\n            return resolve(result);\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * [查询单个用户]\r\n * @param  {[object]} conditions [查询条件]\r\n * @param  {[object]} fields     [过滤字段]\r\n * @param  {[object]} options    [其他操作]\r\n * @return {[type]}            [description]\r\n */\r\nconst findOne = (conditions, fields, options) => {\r\n    // return UserModel.findOne(conditions, fields, options).exec();\r\n\r\n    return new Promise((resolve, reject) => {\r\n        UserModel.findOne(conditions, fields, options).exec((err, doc) => {\r\n            if (err) return reject({ err: err.errors, message: '查询出错!', status: -99 });\r\n            if (!doc) return reject({ err: err.errors, message: '没有此用户!', status: -99 });\r\n            return resolve(doc);\r\n        });\r\n    });\r\n}\r\n\r\nconst update = (where, options, callback) => {\r\n    UserModel.update(where, options, { multi: true }, (err, numberAffected, raw) => {\r\n        if (err) return callback(err);\r\n        callback(null, numberAffected);\r\n    })\r\n}\r\n\r\nexport default {\r\n    save,\r\n    findOne,\r\n    update,\r\n}\r\n"]}